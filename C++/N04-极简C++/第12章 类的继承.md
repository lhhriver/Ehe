# 第1章  C++概述

# 第2章 处理数据

# 第3章 分支结构

# 第4章 循环结构

# 第5章 数组

# 第6章 指针

# 第7章 函数初识

# 第8章 函数进阶

# 第9章 位运算符、构造类型与名称空间

# 第10章 面向对象与类

# 第11章 类的高级主题

# 第12章 类的继承

## 继承的概念与派生类的声明

### 继承的概念

### 派生类的声明

#### **【例12-1】**类的继承案例

##### Shape.h

```c++
//文件:ex12_1\Shape.h
#ifndef SHAPE_H
#define SHAPE_H
#include <iostream>

class Shape
{
private:
    char name[8];
    char color[8];

public:
    Shape(char *name = "none", char *color = "none");
    void setName(char *name);
    void setColor(char *color);
    void draw();
};
#endif
```

##### Shape.cpp

```c++
//文件:ex12_1\Shape.cpp
#include <iostream>
#include <cstring>
#include "Shape.h"
using namespace std;

Shape::Shape(char *name, char *color)
{
    strcpy(this->name, name);
    strcpy(this->color, color);
}

void Shape::setName(char *name)
{
    strcpy(this->name, name);
}

void Shape::setColor(char *color)
{
    strcpy(this->color, color);
}

void Shape::draw() //输出图形的信息
{
    cout << "Draw " << name << " with color " << color << endl;
}

```



##### Circle.h

```c++
//文件:ex12_1\Circle.h
#ifndef CIRCLE_H
#define CIRCLE_H
#include "Shape.h"

class Circle : public Shape // Circle从Shape继承
{
private:
    constexpr static const double PI = 3.14159;  // 需要加constexpr 
    double radius;

public:
    Circle(char *name, char *color, double radius);
    double area();
};
#endif

```

##### Circle.cpp

```c++
//文件:ex12_1\Circle.cpp
#include <iostream>
#include "Circle.h"

using namespace std;
//派生类的构造函数使用初始化表调用基类的构造函数
Circle::Circle(char *name, char *color, double radius) : Shape(name, color)
{
    this->radius = radius;
}

double Circle::area()
{
    return PI * radius * radius;
}

```

##### main.cpp

```c++
//文件:ex12_1\main.cpp
#include <iostream>
using namespace std;
#include "Shape.h"
#include "Circle.h"

int main()
{
    Shape s("Shape1", "Red");
    Circle c("Circle1", "Blue", 10);
    s.draw();
    c.draw(); //调用基类Shape的draw方法
    cout << "圆的面积：" << c.area() << endl;
    c.setName("C1");      //调用基类Shape的setName方法
    c.setColor("Greeen"); //调用基类Shape的setColor方法
    c.draw();             //调用基类Shape的draw方法
    cout << "sizeof(Shape): " << sizeof(Shape) << endl;
    cout << "sizeof(Circle): " << sizeof(Circle) << endl;
}

```

编译：

```shell
g++ -g -o out main.cpp Circle.cpp Shape.cpp
```

执行：

```shell
.\out.exe
```

输出：

```
Draw Shape1 with color Red
Draw Circle1 with color Blue
圆的面积：314.159
Draw C1 with color Greeen
sizeof(Shape): 16
sizeof(Circle): 24
```

## 类的继承方式

### 公有继承

### 保护继承

#### **【例12-2】**保护继承案例

##### Shape.h

```c++
//文件:ex12_2\Shape.h
#ifndef SHAPE_H
#define SHAPE_H
#include <iostream>
class Shape
{
private:
    char name[8];
    char color[8];

public:
    Shape(char *name = "none", char *color = "none");
    void setName(char *name);
    void setColor(char *color);
    void draw();
};
#endif

```

##### Shape.cpp

```c++
//文件:ex12_2\Shape.cpp
#include <iostream>
#include "Shape.h"
#include <cstring>
using namespace std;
Shape::Shape(char *name, char *color)
{
    strcpy(this->name, name);
    strcpy(this->color, color);
}

void Shape::setName(char *name)
{
    strcpy(this->name, name);
}

void Shape::setColor(char *color)
{
    strcpy(this->color, color);
}

void Shape::draw() //输出图形的信息
{
    cout << "Draw " << name << " with color " << color << endl;
}

```

##### Circle.h

```c++
//文件:ex12_2\Circle.h
#ifndef CIRCLE_H
#define CIRCLE_H
#include "Shape.h"
class Circle : protected Shape 
{
private:
    constexpr static const double PI = 3.14159;  // constexpr
    double radius;

public:
    Circle(char *name, char *color, double radius);
    double area();
    void draw();
};
#endif
```

##### Circle.cpp

```c++
//文件:ex12_2\Circle.cpp
#include <iostream>
#include "Circle.h"
using namespace std;
//派生类的构造函数使用初始化表调用基类的构造函数
Circle::Circle(char *name, char *color, double radius) : Shape(name, color)
{
    this->radius = radius;
}
double Circle::area()
{
    return PI * radius * radius;
}
void Circle::draw()
{
    Shape::draw();
}

```

##### main.cpp

```c++
//文件:ex12_2\main.cpp
#include <iostream>
using namespace std;
#include "Shape.h"
#include "Circle.h"
int main()
{
    Shape s("Shape1", "Red");
    Circle c("Circle1", "Blue", 10);
    s.draw();
    c.draw(); //正确，Circle类中定义了公有draw方法
    cout << "圆的面积：" << c.area() << endl;
    //c.setName("C1");      //错误，Circle类中setName为保护访问权限
    //c.setColor("Greeen"); //错误，Circle类中setColor为保护访问权限
    //c.draw();             //错误，Circle类中draw为保护访问权限
    return 0;
}

```

编译：

```shell
g++ -g -o out main.cpp Circle.cpp Shape.cpp
```

执行：

```c++
.\out.exe
```

输出：

```
Draw Shape1 with color Red
Draw Circle1 with color Blue
圆的面积：314.159
```

### 私有继承

### 综合实例

#### **【例12-3】**设计钟表类与闹表类

##### Clock.h

```c++
//文件:ex12_3\Clock.h
#ifndef CLOCK_H
#define CLOCK_H
#include <iostream>
class Clock	 
{
private: 
	int hour;
	int minute;
	int second; 
public: 
	Clock(int hour=0, int minute=0, int second=0);
	Clock(const Clock &c);
	void setTime(int h, int m, int s); 
	void showTime(); 
};
#endif

```

##### Clock.cpp

```c++
//文件:ex12_3\Clock.cpp
#include <iostream>
#include "Clock.h"
using namespace std;
Clock::Clock(int hour, int minute, int second)
{
    this->hour = hour;
    this->minute = minute;
    this->second = second;
}
Clock::Clock(const Clock &c)
{
    hour = c.hour;
    minute = c.minute;
    second = c.second;
}
void Clock::setTime(int hour, int minute, int second)
{
    this->hour = hour;
    this->minute = minute;
    this->second = second;
}
void Clock::showTime()
{
    cout << hour << ":" << minute << ":" << second << endl;
}

```

##### AlermClock.h

```c++
//文件:ex12_3\AlermClock.h
#ifndef ALERMCLOCK_H
#define ALERMCLOCK_H
#include "Clock.h"
class AlermClock : public Clock
{
private:
    int alermHour;
    int alermMinute;
    int alermSecond;

public:
    AlermClock(int hour = 12, int minute = 0, int second = 0,
               int alermHour = 0, int alermMinute = 0, int alermSecond = 0);
    void alerm();
    void setAlermTime(int alermHour, int alermMinute, int alermSecond);
    void showAlermTime();
};
#endif

```

##### AlermClock.cpp

```c++
//文件:ex12_3\AlermClock.cpp
#include <iostream>
#include "AlermClock.h"
#include <windows.h>
using namespace std;
AlermClock::AlermClock(int hour, int minute, int second, int alermHour,
                       int alermMinute, int alermSecond) : Clock(hour, minute, second)
{
    this->alermHour = alermHour;
    this->alermMinute = alermMinute;
    this->alermSecond = alermSecond;
}
void AlermClock::alerm()
{
    for (int i = 0; i < 4; i++)
    {
        cout << '\a';
        Sleep(1000);
    }
}
void AlermClock::setAlermTime(int alermHour, int alermMinute, int alermSecond)
{
    this->alermHour = alermHour;
    this->alermMinute = alermMinute;
    this->alermSecond = alermSecond;
}
void AlermClock::showAlermTime()
{
    cout << alermHour << ":" << alermMinute << ":" << alermSecond << endl;
}

```

##### main.cpp

```c++
//文件:ex12_3\main.cpp
#include <iostream>
#include "AlermClock.h"
using namespace std;
int main()
{
    AlermClock c(13, 30, 30, 17, 20, 10);
    c.showTime();
    c.showAlermTime();
    c.alerm();
    c.setTime(10, 30, 40);
    c.setAlermTime(6, 30, 0);
    c.showTime();
    c.showAlermTime();
    return 0;
}

```

编译：

```shell
g++ -g -o out main.cpp AlermClock.cpp Clock.cpp
```

执行：

```
.\out.exe 
```

输出：

```
13:30:30
17:20:10
10:30:40
6:30:0
```

## 派生类的构造过程和析构过程

### 派生类的构造过程

#### **【例12-4】演示派生类的构造过程的案例**

```c++
//文件:ex12_4.cpp
#include <iostream>
using namespace std;

class A
{
    int a;

public:
    A(int x) : a(x)
    {
        cout << "construct A " << a << endl;
    }
};

class B : public A
{
private:
    int b, c;
    const int d;
    A x, y;

public:
    B(int v) : b(v), y(b + 2), x(b + 1), d(b), A(v) // v=10;  A::a=10; b=10; d = 10; x.a =11; y.a=12
    {
        c = v; // c=10
        cout << "construct B " << b << " " << c << " " << d << endl;
    }
};

int main()
{
    B b1(10);
    return 0;
}
// construct A 10
// construct A 11
// construct A 12
// construct B 10 10 10
```

输出：

```
construct A 10
construct A 11
construct A 12
construct B 10 10 10
```

### 派生类的析构过程

#### **【例 12-5】演示派生美的析約逆程的案例**

```c++
//文件:ex12_5.cpp
#include <iostream>
using namespace std;
class A
{
    int a;

public:
    A(int x) : a(x)
    {
        cout << "construct A " << a << endl;
    }
    ~A()
    {
        cout << "destruct A " << a << endl;
    }
};

class B : public A
{
private:
    int b, c;
    const int d;
    A x, y;

public:
    B(int v) : b(v), y(b + 2), x(b + 1), d(b), A(v) // A::a=10   x.a=11, y.a=12, b=10, c=10,d=10
    {
        c = v;
        cout << "construct B" << b << " " << c << " " << d << endl;
    }
    ~B()
    {
        cout << "destruct B" << b << " " << c << " " << d << endl;
    }
};
int main()
{
    B b1(10);
    return 0;
}

```

输出：

```
construct A 10
construct A 11
construct A 12
construct B10 10 10
destruct B10 10 10
destruct A 12
destruct A 11
destruct A 10
```

### 综合实例

#### **【例12-6】设计图形的相关类**

##### Point.h

```c++
//文件:ex12_6\Point.h
#ifndef POINT_H
#define POINT_H
class Point
{
    int x;
    int y;

public:
    Point(int x = 0, int y = 0);
    Point(const Point &p);
    int getX();
    int getY();
};
#endif

```

##### Point.cpp

```c++
//文件:ex12_6\Point.cpp
#include "Point.h"
Point::Point(int x, int y)
{
    this->x = x;
    this->y = y;
}
Point::Point(const Point &p)
{
    x = p.x;
    y = p.y;
}
int Point::getX()
{
    return x;
}
int Point::getY()
{
    return y;
}

```

##### Shape.h

```c++
//文件:ex12_6\Shape.h
#ifndef SHAPE_H
#define SHAPE_H
class Shape
{
private:
    char Color[10];

public:
    Shape(char *c);
    void draw();
    void outputColor();
};
#endif

```

##### Shape.cpp

```c++
//文件:ex12_6\Shape.cpp
#include <iostream>
#include "Shape.h"
#include <cstring>
using namespace std;

Shape::Shape(char *c)
{
    strcpy(Color, c);
}

void Shape::draw()
{
    cout << "Draw a shape. The color is " << Color << endl;
}

void Shape::outputColor()
{
    cout << Color << endl;
}

```

##### Line.h

```c++
//文件:ex12_6\Line.h
#ifndef LINE_H
#define LINE_H
#include "Shape.h"
#include "Point.h"

class Line : public Shape
{
private:
    Point start;
    Point end;

public:
    Line(const Point &s, const Point &e, char *c);
    void draw();
};
#endif

```

##### Line.cpp

```c++
//文件:ex12_6\Line.cpp
#include <iostream>
#include "Line.h"
using namespace std;

Line::Line(const Point &s, const Point &e, char *c) : Shape(c), start(s), end(e)
{
}

void Line::draw()
{
    cout << "Draw a Line from (" << start.getX() << "," << start.getY();
    cout << ") to (" << end.getX() << "," << end.getY() << "), with color ";
    outputColor();
}

```

##### Circle.h

```c++
//文件:ex12_6\Circle.h
#ifndef CIRCLE_H
#define CIRCLE_H
#include "Shape.h"
#include "Point.h"

class Circle : public Shape
{
private:
    Point center;
    int radius;

public:
    Circle(const Point &ct, int radius, char *color);
    void draw();
};
#endif

```

##### Circle.cpp

```c++
//文件:ex12_6\Circle.cpp
#include <iostream>
#include "Circle.h"
using namespace std;
Circle::Circle(const Point &ct, int radius, char *color) : Shape(color), center(ct)
{
    this->radius = radius;
}

void Circle::draw()
{
    cout << "Draw a circle at center (" << center.getX() << ",";
    cout << center.getY() << ") with radius " << radius << " and color ";
    outputColor();
}
```

##### main.cpp

```c++
//文件:ex12_6\main.cpp
#include "Line.h"
#include "Circle.h"

// int main()
//{
//	Shape s("Red");
//	Point p1(10,10), p2(100,100),p3(50,50);
//	Line  l(p1,p2,"Green");
//	Circle c(p3, 20, "Black");
//	s.draw();
//	l.draw();
//	c.draw();
//	return 0;
// }

int main()
{
    Shape *ps[3];
    Shape s("Red");
    Point p1(10, 10), p2(100, 100), p3(50, 50);
    Line l(p1, p2, "Green");
    Circle c(p3, 20, "Black");
    ps[0] = &s;
    ps[1] = &l;
    ps[2] = &c;
    for (int i = 0; i < 3; i++)
        ps[i]->draw();
    return 0;
}

```

编译：

```shell
g++ -g -o out main.cpp Circle.cpp Line.cpp Shape.cpp Point.cpp
```

执行：

```
 .\out.exe
```

输出：

```
Draw a shape. The color is Red
Draw a shape. The color is Green
Draw a shape. The color is Black
```

## 多继承简介

### **【例12-7】多继承派生类的构造过程与析构过程**

```c++
//文件:ex12_7.cpp
#include <iostream>
using namespace std;

class Base1
{
protected:
    int b;

public:
    Base1(int x = 0)
    {
        b = x;
        cout << "Construct Base1!  " << b << endl;
    }
    
    ~Base1()
    {
        cout << "Destruct  Base1!  " << b << endl;
    }
};

class Base2
{
protected:
    int b;

public:
    Base2(int x = 0)
    {
        b = x;
        cout << "Construct Base2!  " << b << endl;
    }
    
    ~Base2()
    {
        cout << "Destruct  Base2!  " << b << endl;
    }
};

class Derived : public Base1, private Base2
{
protected:
    Base1 b1;
    Base2 b2;
    int d;

public:
    Derived(int x, int y, int z) : b1(y), Base2(y), b2(z), Base1(x) //  Base1::b=1,  Base2::b=2, b1.b=2 b2.b=3
    {
        d = z; // d=3
        cout << "Construct Derived! " << d << endl;
    }
    
    ~Derived()
    {
        cout << "Destruct  Derived! " << d << endl;
    }
};

int main()
{
    Derived d1(1, 2, 3);
    return 0;
}
```

输出：

```
Construct Base1!  1
Construct Base2!  2
Construct Base1!  2
Construct Base2!  3
Construct Derived! 3
Destruct  Derived! 3
Destruct  Base2!  3
Destruct  Base1!  2
Destruct  Base2!  2
Destruct  Base1!  1
```

## 小结

## 习题十二











