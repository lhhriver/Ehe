# 第1章  C++概述

# 第2章 处理数据

# 第3章 分支结构

# 第4章 循环结构

# 第5章 数组

# 第6章 指针

## 地址与指针的概念

### 内存地址

### 变量的地址

### 6.13 变量的指针



## 指针变量及指针运算

### 指针变量

#### **【例6-1】通过指针变量存取变量的值**

```c++
//文件:ex6_1.cpp
#include <iostream>
using namespace std;
int main()
{
    int a, *p1;    // p1只能保存int变量的地址
    double b, *p2; // p2只能保存double变量的地址
    char c, *p3;   // p3只能保存char变量的地址
    
    p1 = &a;       // 将a的地址赋给p1 ，也称p1指向了a
    p2 = &b;       // 将b的地址赋给p2 ，也称p2指向了b
    p3 = &c;       // 将c的地址赋给p3 ，也称p3指向了c
    
    *p1 = 10;      // 将p1指向的的单元赋值为10
    *p2 = 11.2;    // 将p2指向的的单元赋值为11.2
    *p3 = 'A';     // 将p3指向的的单元赋值为'A'
    
    cout << a << " " << b << " " << c << endl;
    cout << *p1 << " " << *p2 << " " << *p3 << endl;
    cout << p1 << " " << p2 << " " << p3 << endl;
    cout << &a << " " << &b << " " << &c << endl;
    cout << (double *)(&c) << " " << (int *)(&c) << " " << (void *)(&c) << endl;
    return 0;
}

```

输出：

```
10 11.2 A
10 11.2 A
0x61fe04 0x61fdf8 Affffff&@
0x61fe04 0x61fdf8 Affffff&@
0x61fdf7 0x61fdf7 0x61fdf7
```

#### **【例 6-2】输入a和b两个整数、按从小到大的顺序输出**

```c++
//文件:ex6_2.cpp
#include <iostream>
using namespace std;
int main()
{
    int a, b;
    int *p1, *p2, *p;
    
    cout << "请输入两个整数：";
    cin >> a >> b;
    
    p1 = &a;       // p1保存a的地址，p1指向a
    p2 = &b;       // p2保存b的地址，p2指向b
    
    if (*p1 > *p2) //相当于如果if(a>b)
    {
        p = p1; //交换p1和p2的值，p1指向b，p2指向a，p1指向值小的变量
        p1 = p2;
        p2 = p;
    }
    
    cout << "min=" << *p1 << "  max=" << *p2 << endl;
    return 0;
}

```

输出：

```
请输入两个整数：25 36
min=25  max=36
```

### 指针运算

#### **【例6-3】指针与整数的加减运算**

```c++
//文件:ex6_3.cpp
#include <iostream>
using namespace std;
int main()
{
    int a, *p1, *p2;
    double b, *p3, *p4;
    
    p1 = &a;
    p3 = &b;
    cout << p1 << "  " << p3 << endl;
    
    p2 = p1 + 1; //加4个字节
    p4 = p3 + 1; //加8个字节
    cout << p2 << "  " << p4 << endl;
    
    p2 = p1 - 1; //减4个字节
    p4 = p3 - 1; //减8个字节
    cout << p2 << "  " << p4 << endl;
    
    p2 = p1 + 5; //加20个字节
    p4 = p3 + 5; //加40个字节
    cout << p2 << "  " << p4 << endl;
    return 0;
}

```

输出：

```
0x61fdfc  0x61fdf0
0x61fe00  0x61fdf8
0x61fdf8  0x61fde8
0x61fe10  0x61fe18
```
#### **【例6-4】指针的关系运算**

```c++
//文件:ex6_4.cpp
#include <iostream>
using namespace std;
int main()
{
    int a[10] = {1, 2, 3, 4, 5, 6, 7, 8, 9, 10};
    int *p1, *p2;
    p1 = &a[3];
    p2 = &a[8];
    
    cout << "p1 > p2:  " << (p1 > p2) << endl;  // false
    cout << "p1 < p2:  " << (p1 < p2) << endl;  // true
    cout << "p1 == p2: " << (p1 == p2) << endl; // false
    cout << "p1 != p2: " << (p1 != p2) << endl; // true
    cout << "p1 - p2:  " << (p1 - p2) << endl;  // -5
    cout << "p2 - p1:  " << (p2 - p1) << endl;  //  5
    return 0;
}

```

输出：

```
p1 > p2:  0
p1 < p2:  1
p1 == p2: 0
p1 != p2: 1
p1 - p2:  -5
p2 - p1:  5
```

## 指针与数组

### 使用指针处理数组

#### **【例6-5】使用指针输出数组中的所有元素**

```c++
//文件:ex6_5.cpp
#include <iostream>
using namespace std;
int main()
{
    int a[6] = {1, 2, 3, 4, 5, 6};
    int *p;
    p = a; //相当于p=&a[0]
    
    for (int i = 0; i < 6; i++)
    {
        cout << *p << "  ";
        p++;
    }
    cout << endl;
    return 0;
}

```

输出：

```
1  2  3  4  5  6 
```

### 指针数组

#### **【例6-6】用指针数组处理二维数组的元素**

```c++
//文件:ex6_6.cpp
#include <iostream>
using namespace std;
int main()
{
    int a[3][3] = {{1, 0, 0}, {0, 1, 0}, {0, 0, 1}};
    int *p[3];   //声明整型指针数组
    
    p[0] = a[0]; // a[0]是二维数组第一行的首地址  &a[0][0]
    p[1] = a[1]; // a[1]是二维数组第二行的首地址  &a[1][0]
    p[2] = a[2]; // a[2]是三维数组第一行的首地址  &a[2][0]
    
    for (int i = 0; i < 3; i++)
    {
        for (int j = 0; j < 3; j++)
        {
            // cout<<p[i][j]<<" ";//*(p[i] + j)
            cout << *(p[i] + j) << " "; //*(p[i] + j)
        }
        cout << endl;
    }
    return 0;
}

```

输出：

```
1 0 0 
0 1 0 
0 0 1 
```

### 多级指针

#### **【例 6-7】二级指针的应用**

```c++
//文件:ex6_7.cpp
#include <iostream>
using namespace std;
int main()
{
    int a, *p1, **p2;
    double b, *p3, **p4;
    
    a = 10;
    b = 22.3;
    
    p1 = &a;  // p1一级整型指针，a整型变量
    p3 = &b;  // p3一级实型指针，b实型变量
    p2 = &p1; // p2二级整型指针，p1一级整型指针
    p4 = &p3; // p4二级实型指针，p3一级实型指针
    
    cout << a << "\t" << *p1 << "\t" << **p2 << endl;
    cout << b << "\t" << *p3 << "\t" << **p4 << endl;
    
    **p2 = 20;
    **p4 = 45.8;
    
    cout << a << "\t" << *p1 << "\t" << **p2 << endl;
    cout << b << "\t" << *p3 << "\t" << **p4 << endl;
    return 0;
}

```

输出：

```
10      10      10
22.3    22.3    22.3
20      20      20
45.8    45.8    45.8
```



#### **【例6-8】二维数组的地址**

```c++
//文件:ex6_8.cpp
#include <iostream>
using namespace std;

int main()
{
    int a[3][4] = {
        {1, 2, 3, 4},
        {5, 6, 7, 8},
        {9, 10, 11, 12}};
    
    cout << a << "  " << &a[0] << "  " << &a[0][0] << endl;
    cout << a + 1 << "  " << &a[1] << "  " << &a[1][0] << endl;
    cout << a + 2 << "  " << &a[2] << "  " << &a[2][0] << endl;
    cout << *a << "  " << **a << "  " << *a[0] << endl;
    cout << *(*(a + 1)) << "  " << *(*a + 1) << endl;
    cout << *(*(a + 1) + 2) << "  " << a[1][2] << endl;
    return 0;
}

```

输出：

```
0x61fdf0  0x61fdf0  0x61fdf0
0x61fe00  0x61fe00  0x61fe00
0x61fe10  0x61fe10  0x61fe10
0x61fdf0  1  1
5  2
7  7
```



### 数组指针

#### **【例6-9】使用数组指针访问二维数组**

```c++
//文件:ex6_9.cpp
#include <iostream>
using namespace std;
int main()
{
    int a[3][4] = {
        {1, 2, 3, 4},
        {5, 6, 7, 8},
        {9, 10, 11, 12}};
    
    int(*p)[4];
    
    p = a; //也可以写成 p = &a[0]; 保存第一行的地址
    
    for (int i = 0; i < 3; i++)
    {
        for (int j = 0; j < 4; j++)
        {
            cout << *(*p + j) << "\t";
        }
        cout << endl;
        p++; //指向下一行
    }
    return 0;
}

```

输出：

```
1       2       3       4
5       6       7       8
9       10      11      12
```

## 常量指针与指针常量

### 常量指针

#### **【例6-10】常量指针的使用**

```c++
//文件:ex6_10.cpp
#include <iostream>
using namespace std;
int main()
{
    const char *str = "C++ Programming.";
    cout << str << endl;
    // str[0] = 'c';		//语法错误，不能改变常量的值

    char *str1 = "C++ Programming.";
    cout << str1 << endl;
    str1[0] = 'A';

    cout << str1 << endl;
    return 0;
}

```

输出：

```
C++ Programming.
C++ Programming.
```

### 指针常量

#### **【例6-11】指针常量的使用**

```c++
//文件:ex6_11.cpp
#include <iostream>
using namespace std;
int main()
{
    int a = 10, b = 20;
    int *const p = &a;
    cout << *p << endl;
    *p = 20;
    cout << *p << endl;
    // p = &b; //语法错误，不能改变指针常量的值

    return 0;
}

```

输出：

```
10
20
```



## 动态内存分配

### 分配单个存储空间

### 分配多个连续的存储空间

#### **【例 6-12】动态内存分配的使用**

```c++
//文件:ex6_12.cpp
#include <iostream>
using namespace std;

int main()
{
    int *p1, *p2;
    p1 = new int(10); //分配一个int型内存单元，并初始化为10
    p2 = new int[10]; //分配一个10个连续的int型内存单元
    int i;
    
    for (i = 0; i < 10; i++) //为每个单元赋值
        *(p2 + i) = i;
    cout << *p1 << endl;     // p1指向的内容
    
    for (i = 0; i < 10; i++) //输出p2指向的10个整数
        cout << *(p2 + i) << "  ";
    cout << endl;
    
    for (i = 0; i < 10; i++) //另一种方式输出p2指向的10个整数
        cout << p2[i] << "  ";
    cout << endl;
    
    delete p1;   //释放p1指向的存储单元
    delete[] p2; //释放p2指向的多个连续存储单元
    return 0;
}

```

输出：

```
10
0  1  2  3  4  5  6  7  8  9  
0  1  2  3  4  5  6  7  8  9 
```



## 综合实例

### **【例6-13】使用二级指针指向指针数组**

```c++
//文件:ex6_13.cpp
#include <iostream>
using namespace std;
int main()
{
    const char *name[] = {"Basic", "Pascal", "Fortran", "C++"};
    const char **p;
    int i;
    
    for (i = 0; i < 4; i++)
    {
        p = name + i;
        cout << *p << endl;
    }
    return 0;
}

```

输出：

```
Basic
Pascal
Fortran
C++
```

### **【例6-14】使用选择排序对字符串排序**

```c++
//文件:ex6_14.cpp
#include <iostream>
#include <cstring>
using namespace std;
int main()
{
    char *name[4];
    name[0] = new char[strlen("Basic") + 1];
    name[1] = new char[strlen("Pascal") + 1];
    name[2] = new char[strlen("C++") + 1];
    name[3] = new char[strlen("Fortran") + 1];
    
    strcpy(name[0], "Basic");
    strcpy(name[1], "Pascal");
    strcpy(name[2], "Fortran");
    strcpy(name[3], "C++");
    
    int n = sizeof(name) / sizeof(name[0]); //求数组name的元素个数
    int i, j, k;
    char *p;
    
    for (i = 0; i < n - 1; i++)
    {
        k = i;                      //保存最小元素的下标
        for (j = i + 1; j < n; j++) //找到未排序中最小元素的小标
            if (strcmp(name[j], name[k]) < 0)
                k = j;
        if (k != i) //如果k不是待排序中最小下标，则将name[i]与name[k]交换
        {
            p = name[i];
            name[i] = name[k];
            name[k] = p;
        }
    }
    
    for (i = 0; i < n; i++)
    {
        cout << name[i] << endl;
    }

    return 0;
}

```

输出：

```
Basic
C++
Fortran
Pascal
```

#### **【例6-15】报数出圈问题**

```c++
//文件:ex6_15.cpp
#include <iostream>
using namespace std;
int main()
{
    int a[10] = {1, 2, 3, 4, 5, 6, 7, 8, 9, 10};
    int *p = a;
    int m, i;
    m = 10;       //剩下的人数
    i = 0;        // 1--3计数
    while (m > 1) //剩余人数为1时结束循环
    {
        if (*p != -1) //该位置人还没有退出
        {
            i++; //报数加1
            if (i == 3)
            {            //报数到第三个人，出圈
                m--;     //剩下人数减1
                *p = -1; //标记该位置已无人
                i = 0;   //重新报数
            }
        }
        
        p++; //指向下一个元素
        if (p > &a[9])
        { //超出数组范围，重新指向第一个元素
            p = a;
        }
    }
    
    for (i = 0; i < 10; i++)
    {                   //在数组找不是-1的元素，就是剩下的最后一个
        if (a[i] != -1) //循环结束后，就是剩下的下最后一个元素的下标
            break;
    }
    cout << "最后剩下的序号是：" << i + 1 << endl; //序号是下标加1
    return 0;
}

```

输出：

```
最后剩下的序号是：4
```



##  小结

## 习题六



















