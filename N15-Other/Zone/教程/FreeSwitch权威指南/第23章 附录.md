# 附录A　FreeSWITCH开源软件社区指南

FreeSWITCH是一个开源项目，也是一个开发者社区。FreeSWITCH的开发很活跃，开发者及社区的成员都很友好。我们欢迎所有人加入FreeSWITCH社区，一起学习、讨论，并贡献自己的力量，使我们的社区和我们的项目越办越好。

## A.1　中文社区

- http://www.freeswitch.org.cn。FreeSWITCH中文社区，名称是FreeSWITCH-CN，社区的最新消息都会发布在这里。
- http://groups.google.com/group/freeswitch-cn。Google Groups的中文邮件列表。
- 专业的QQ群：190435825。
- 微信公众平台：FreeSWITCH-CN。

我们每年都会不定期举办中国区的FreeSWITCH沙龙线下活动。这些活动信息将在www.freeswitch.org.cn网站上发布。

## A.2　英文社区

- http://www.freeswitch.org。FreeSWITCH的官方网站。
- http://wiki.freeswitch.org。英文的Wiki网站，资料丰富。
- http://lists.freeswitch.org。一个邮件列表（大部分用户可以从freeswitch-users邮件列表开始）。
- http://freenode.net。一个IRC站点，其中有一个供大家交流的“#freeswitch”频道，类似于中国的QQ群。
- http://jira.freeswitch.org。一个缺陷跟踪系统，可以在这里汇报Bug，或者提新需求。如果希望自己的新需求快速得到响应，可以提交一个Bounty（Bounty的意思是你希望实现一个新需求并愿意为之付费）。
- http://files.freeswitch.org。提供各种FreeSWITCH资源的下载，包括源代码和已编译的程序等。
- http://cluecon.com。ClueCon [1]的主站。
- http://wiki.freeswitch.org/wiki/Weekly_Conference_Call。列出了FreeSWITCH电话会议 [2]的参与方式及历史会议的录音。

[1] ClueCon是一年一度的开发者技术交流会，每年8月份在美国芝加哥举行。 

[2] 电话会议是FreeSWITCH社区成员使用语音交流的一种方式。基本上是每周三UTC时间下午6点开始，每周五不定时也有Friday Free For All的会议。支持使用WebRTC、Flash、SIP、H323以及PSTN等多种方式参加会议。

# 附录B　关于FreeSWITCH常用术语翻译的意见

FreeSWITCH的大多数资料都是英文的，因而很多情况下，为了方便阅读或者与其他人交流，都需要将原文翻译成中文。下面就简单谈一下笔者对翻译的理解及针对FreeSWITCH的特定术语的翻译。

众所周知，翻译的最高境界是“信、达、雅”，通俗来讲就是“正确、易懂、得体”，它实际上是从“内容、表达、风格”三方面来要求的。但拘泥于以上标准往往会受到很多限制，尤其是对于科技作品来说，用上述观点来评价翻译作品则更难保证评价的正确性和客观性。

一般来说，翻译包括原著与目标语言读者两个对象。那么，我们在翻译时，除了应该忠实于原文外，更应该考虑的是目标读者。比方说，某件事情或动作，对于原著语言的读者来说可能是习以为常的，但对于目标语言的读者来说可能很陌生或根本不知道是怎么回事。这时我们就应该允许译者加入相关背景知识的脚注，或者直接用目标语言读者熟悉的、类似的表达方式来表达。

FreeSWITCH资料大部分来自其官方Wiki或者邮件列表，是来自全球众多网友的贡献。其作者大部分是程序员或技术人员，因此他们大都不太注重语法和修辞，并且这种网络媒体写起来本身就比较自由，再加上还有好多俚语和网络语言，甚至有不少文章也是出自非英语母语的人之手，这就更难保证语法的正确性了，因而翻译起来就非常困难了。在此，笔者主张遇到某些难以翻译的句子时，尽量把长句拆成短句，在充分了解原作的基础上甚至可以用自己的语言表达（Anthony最喜欢写长句了）。因为我们最重要的任务让读中文的人能理解它，而不是一味地“忠于”原文。

关于英文中的术语，可译可不译。如：没有人会把“HTTP”译成“超文本传输协议”，也没有人把“XML”译成“可扩展标记语言”。为什么？因为它们是众所周知的，至少在技术领域是这样。但对于某些特定领域的术语，有一些甚至在中文中没有对应的词，怎么办呢？最简单的答案是不译，这些既能最大程度地忠于原文，又不会让读者不知所云。当然，如果你的水平很高，你创造一个新词也可能成为国际标准，那就另当别论了。

对于某些缩写，最好能标注原文。有些书会在附录里列一个术语对照表，但笔者认为，大多数情况下还是直接注在正文（用括号或脚注）中较好，而且只需在第一次出现时加注。如PSTN（Public Switched Telephone Network，公共电话交换网）、ENUM（E.164 NUmber Mapping，E164号码映射）。当然，对于非专业的读者来说，他们可能还是不知道是什么，如果你面向的是这样的读者，那最好在脚注里（或超文本里）加个指向比较权威资料（如维基百科）的链接。举个例子，大部分人都不知道自己家电话所在的网络叫“公用电话交换网”，更不用说PSTN了。那么，在某些场合说到它与VoIP的区别时，我们一般称之为“普通电话网”或“传统电话网”。

以下是本书中笔者对FreeSWITCH相关术语的译法，不当之处请广大读者批评指正。

- Dialplan：拨号计划（虽然在Asterisk的书中译为“拨号方案”，但笔者还是认为“拨号计划”较好）。
- Endpoint：终点（专有名词，可不译）。
- ASR/TTS：自动语音识别/文本语音转换（语音合成）。
- Directory：FreeSWITCH中的用户目录，或者通用的目录服务（如LDAP）。
- Events：事件。
- Event handlers：事件句柄。
- Event Socket：事件套接字（可不译）。
- Formats：格式。
- Loggers：日志。
- Languages：语言。
- Say：说（可不译）。
- Phrase：短语（可不译）。
- Timers：定时器，或译为计时器。
- Applications：应用。
- FSAPI：FreeSWITCH应用程序接口，或译为FreeSWITCH命令接口。
- CDR：呼叫详单，或译为呼叫详细记录。
- PSTN：公共电话交换网。
- SIP：会话初始协议。
- SIP UA：SIP用户代理。
- UAC/UAS：用户代理客户端/服务器端。
- Sofia Profile：Sofia配置文件（可不译）。
- Gateway：网关。
- VoIP：不译。

# 附录C　模块列表

FreeSWITCH的模块有很多，它们丰富了FreeSWITCH的功能。实际上，常用的模块本书已经基本都介绍过了。但总有好奇的读者会问：不知道mod_xxx这个模块是干什么用的？因此，这里列出大部分已知的模块，供广大读者参考。有的模块在前面介绍得很详细了，在这里就从简了，另外有些模块笔者也没有用过，说错了不如不说，因而也会一笔带过。

关于模块的介绍，在官方的Wiki页面上（http://wiki.freeswitch.org/wiki/Modules）大部分都能查到。部分模块也有自己的页面，它们的URL也比较规范，如我们已经介绍过的http://wiki.freeswitch.org/wiki/Mod_sofia、http://wiki.freeswitch.org/wiki/Mod_dptools、http://wiki.freeswitch.org/wiki/Mod_commands等。

我们基于FreeSWITCH 1.2.22版，以自然的顺序来讲解。这里模块的顺序是在FreeSWITCH源代码目录中用以下命令生成的：

```
$ cd src/mod
$ find . -type d -name mod_*
```

各个模块根据其主要功能和提供的接口的不同被分配不同的目录中。

1. applications

该目录下的模块提供了大部分应用的功能，有的模块因实现了多种Interface而不好归类，这些模块也会存在该目录中。

- mod_abstraction：用于创建新的API命令。新的命令可以基于原有的API创建，相当于创建原有命令的别名或快捷方式。

- mod_avmd：avmd是Advanced Voice Mail Detection的缩写，即高级语音邮件检测。它是mod_vmd的高级版。详见mod_vmd。

- mod_blacklist：黑名单功能。它提供了一些通过Dialplan来添加、删除以及检查黑名单的方法。

- mod_callcenter：一个比较强大的呼叫中心类应用。

- mod_cidlookup：用于主叫号码查询，即可根据主叫号码从本地数据库或网络上查询到主叫的名字。网络上有开放的服务，如下面的例子使用curl命令获取与16502530000对应的主叫号码：

    ```
    $ curl https://api.opencnam.com/v2/phone/16502530000?format=pbx
        GOOGLE INC
    ```

- mod_cluechoo：该模块是一个例子模块，主要是教大家怎么写模块。另外，它还带了一个好玩的例子，如在命令行上执行cluechoo命令在屏幕上将会看到开过一个小火车。

- mod_commands：提供了大部分系统的命令API。

- mod_conference：多人语音及视频会议。

- mod_curl：使用libcurl作为一个HTTP客户端向Web服务器发送请求，也可以得到返回的结果。

- mod_db：该模块提供一组接口，用于使用API或App对数据库表进行增、删、改、查等操作。

- mod_directory：该模块用于按姓名呼叫用户。如果不知道用户的分机号，但知道用户的名字，则可以通过输入该用户名字的前几位进行拨叫。如在下面的例子中，我们可以通过拨打411进入directory程序。

```xml
<extension name="directory" continue="true">
    <condition field="destination_number" expression="^411$">
        <action application="directory" data="default $${domain} default"/>
    </condition>
</extension>
```

当系统提示输入名字时，我们输入9378可以找到Brian West（默认是按last_name查找的，West对应键盘按键9378）。

- mod_distributor：如果需要通过多个网关出局，则该模块可以帮助将呼叫根据一定的比例分发到不同的网关。
- mod_dptools：提供了大部分系统的App。
- mod_easyroute：用于根据号码路由，对大规模的DID比较有用。
- mod_enum：通过ENUM查询可以根据E164号码找到用户的SIP地址。该模块也提供了一个enum Dialplan。
- mod_esf：esf是Extended SIP Functionality的缩写，即扩展的SIP功能。它提供通过Muticast方法实现组拨的功能。
- mod_esl：该模块用于实现两个FreeSWITCH间的ESL对接，即一个FreeSWITCH可以作为另一个FreeSWITCH的ESL客户端访问它。
- mod_expr：提供expr表达式计算。
- mod_fifo：一个先入先出队列（First In First Out），可以用于简单地呼叫中心排队。
- mod_fsk：收发FSK（Frequency-shift keying，移频键控）信息。
- mod_fsv：fsv是FreeSWITCH Video的缩写，它使用了一种私有的格式来进行视频录像，可以支持任何编码的视频格式。它只存储原始的RTP包，对视频流不进行任何处理。
- mod_hash：用于操作系统内部的哈希表。可以存储一些简单的数据。
- mod_httapi：一种HTTP格式的API接口，可以通过HTTP方式写IVR。
- mod_http_cache：通过HTTP方式上传和下载文件，并可以进行本地缓存。
- mod_ladspa：使用ladspa库对声音进行处理，可以让声音更好听。
- mod_lcr：LCR是Least Cost Routing的缩写，即最省钱的路由。它会根据数据库配置的路由信息和费率找到最省钱的路由。
- mod_limit：用于系统资源限制。
- mod_memcache：与Memcache交互，类似于把mod_hash的数据存到远程的Memcache中。
- mod_mongo：与Mongodb交互，类似mod_memcache。
- mod_mp4：提供MP4文件的播放支持。
- mod_nibblebill：一些简单的计费功能，可用于预付费和电话卡类的应用。
- mod_oreka：使用oreka进行录音。oreka是一款开源的录音软件。
- mod_osp：通过Open Settlement Protocol查找路由或上报CDR。
- mod_rad_auth：使用radius服务器进行鉴权。
- mod_random：通过访问/dev/hwrandom设备影响随机数的熵。
- mod_redis：与redis服务器交互，类似于mod_memcache。
- mod_rss：访问RSS（Really Simple Syndication，简易信息聚合）数据。
- mod_skel：一个模块的例子框架。
- mod_sms：处理文本消息，如收发SIP MESSAGE消息等。它实现了消息路由（Chazplan），类似于Dialplan。
- mod_snapshot：可以截取一段声音的快照。
- mod_snipe_hunt：一个简单的例子模块。
- mod_snom：用于snom话机的一些特性。
- mod_sonar：该模块类似于一个真正的声呐。首先你可以在远端启动一个服务器，其能对来话执行echo App。然后在本地的FreeSWITCH上产生一些铃音，发送到远端的服务器上再反射回来，然后使用VAD检测功能可以检测这些铃音，从而可以在某种程度上确定网络的质量。
- mod_soundtouch：使用soundtouch库对声音进行处理，可以增加音效。
- mod_spandsp：使用spandsp [1]支持一些语音编码及传真功能。
- mod_spy：用于监视某个话机，当该话机有通话时，本机振铃同时可以监听。
- mod_stress：使用快速傅里叶变换（Fast Fourier Transform，FFT）检测重音。
- mod_translate：通过既定的规则对号码进行翻译。
- mod_valet_parking：电话停靠。类似于泊车，有来电时可以将来电依靠在某个泊位上，然后通知某人拨打指定的号码将来话“接”走。
- mod_vmd：提供Voicemail声音检测。在国外，好多电话都有自动应答功能，如“您好，主人不在家，请留言”。使用该模块可检测到这种声音，应用程序在自动外呼时就可以根据它的结果判断是人工接听的还是机器接听的。
- mod_voicemail：语音邮箱。
- mod_voicemail_ivr：带IVR导航的语音邮箱。

2. asr_tts

该目录下的模块提供自动语音识别及语音合成的功能。

- mod_cepstral：使用Cepstra语音库支持TTS。

- mod_flite：使用Festival Lite库支持TTS。

- mod_pocketsphinx：使用pocketsphinx库支持语音识别。

- mod_tts_commandline：通过命令行程序使用TTS。

- mod_unimrcp：通过uniMRCP协议与其他ASR/TTS产品对接。uniMRCP是一个标准的协议，很多语音产品都支持它。

    

3. codecs

该目录下的模块各种类型的音频、视频编码。大多数名称都很直观，这里不再过多解释。

- mod_amr。
- mod_amrwb。
- mod_b64：Base64编码，可以传输任意数据。
- mod_bv：BroadVoice的编码。
- mod_celt。
- mod_codec2。
- mod_com_g729：商业的G.729编码，可转码，需要许可证。
- mod_dahdi_codec：通过DAHDI库提供的编码。
- mod_g723_1。
- mod_g729：只支持透传。
- mod_h26x：提供H261，H263，H264等视频编码。
- mod_ilbc。
- mod_isac。
- mod_mp4v。
- mod_opus。
- mod_sangoma_codec：通过硬件板卡支持包括G.729、iLBC等多种编码。
- mod_silk。
- mod_siren。
- mod_skel_codec：例子模块。
- mod_speex。
- mod_theora。
- mod_voipcodecs。
- mod_vp8。

4. dialplans

该目录下的模块提供拨号计划。

- mod_dialplan_asterisk：类似于Asterisk格式的拨号计划。
- mod_dialplan_directory：通过LDAP查询拨号计划。
- mod_dialplan_xml：XML拨号计划。

5. directories

该目录下的模块提供目录服务。

mod_ldap：通过LDAP提供目录服务。

6. endpoints

该目录下的模块提供各种Endpoint的实现。

- mod_alsa：使用ALSA声卡。
- mod_dingaling：连接Google Talk。
- mod_gsmopen：使用无线上网卡上的GSM接口或使用手机上的GSM接口给外界发短信或与外界通话。
- mod_h323：连接H.323设备，使用OpenH323库实现。
- mod_khomp：使用KHOMP板卡。
- mod_loopback：提供loopback回环接口。
- mod_opal：连接H.323设备，使用OPAL库实现。
- mod_portaudio：通过Portaudio库支持本地声卡。
- mod_rtmp：通过Adobe的RTMP协议与浏览器中的Flash电话进行通话。
- mod_skinny：支持思科的SCCP协议话机。
- mod_skypopen：与Skype互通。
- mod_sofia：SIP模块。

7. event_handlers

该目录下的模块提供事件处理功能。

- mod_cdr_csv：CSV格式的话单。
- mod_cdr_mongodb：将话单写入Mongodb。
- mod_cdr_pg_csv：将话单写入PostgreSQL数据库。
- mod_cdr_sqlite：将话单写入SQLite数据库。
- mod_erlang_event：对接Erlang节点，提供事件、日志、命令接口等。
- mod_event_multicast：将事件通过组播方式发出去。
- mod_event_socket：通过ESL库与第三方的接口。
- mod_event_test：测试。
- mod_event_zmq：使用ZeroMQ协议与第三方对接。
- mod_json_cdr：JSON格式的CDR。
- mod_radius_cdr：将CDR写入Radius服务器。
- mod_rayo：Rayo支持。
- mod_snmp：SNMP网管接口。

8. formats

该目录下的模块提供各种格式的文件。

- mod_local_stream：从本地文件生成媒体流。
- mod_native_file：支持原生文件读写，如直接读写.PCMU或.G729格式的文件。
- mod_portaudio_stream：使用portaudio库从本地声卡生成媒体流。
- mod_shell_stream：从Shell命令中生成媒体流。
- mod_shout：提MP3文件格式支持和远程Shoutcast服务器支持。
- mod_sndfile：使用libsndfile支持大多数的声音文件。
- mod_ssml：SSML格式的文件支持。
- mod_tone_stream：生成铃流音。
- mod_vlc：使用libvlc提供媒体文件格式的支持。

9. languages

该目录下的模块提供各种嵌入式编码语言接口。

- mod_java：Java的接口。
- mod_lua：Lua的接口。
- mod_managed：微软平台的语言接口，如C#、VB.NET等。
- mod_perl：Perl的接口。
- mod_python：Python的接口。
- mod_spidermonkey：JavaScript的接口。
- mod_v8：使用V8 Javascript引擎实现的JavaScript模块，可替换mod_spidermonkey。
- mod_yaml：Yaml的接口。

10. loggers

该目录下的模块提供与日志相关的功能。

- mod_console：控制台日志。
- mod_logfile：日志文件。
- mod_syslog：将日志写到Syslog。

11. say

该目录下的模块提供多语种接口。

- mod_say_de：德语。
- mod_say_en：英语。
- mod_say_es：西班牙语。
- mod_say_fa：波斯语。
- mod_say_fr：法语。
- mod_say_he：希伯来语。
- mod_say_hr：克罗地亚语。
- mod_say_hu：匈牙利语。
- mod_say_it：意大利语。
- mod_say_ja：日语。
- mod_say_nl：荷兰语。
- mod_say_pl：波兰语。
- mod_say_pt：葡萄牙语。
- mod_say_ru：俄语。
- mod_say_th：泰语。
- mod_say_zh：汉语。

12. timers

该目录下的模块提供与定时器相关的功能。

- mod_posix_timer：Posix定时器。
- mod_timerfd：使用Linux内核中的timerfd定时器。

13. xml_int

该目录下的模块提供XML接口。

- mod_xml_cdr：使用XML格式写CDR。
- mod_xml_curl：从远程HTTP服务器获取XML配置。
- mod_xml_ldap：从远程LDAP服务器获取XML配置。
- mod_xml_radius：从远程Radius服务器获取XML配置。
- mod_xml_rpc：使用XMLRPC接口与第三方交互，提供命令、日志及事件接口等。其本身也是一个简单的Web服务器，并提供一个简单的Web管理界面。
- mod_xml_scgi：使用SCGI协议获取XML配置。

[1] http://www.soft-switch.org/。

# 附录D　FreeSWITCH架构详细示意图

![](https://gitee.com/liuhuihe/Ehe/raw/master/images/FreeSwitch权威指南-20211225-182224-536853.png)
